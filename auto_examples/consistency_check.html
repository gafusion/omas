
<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>IMAS consistency check &#8212; OMAS</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css?v=49fa7461" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=61a4c737" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.12.4.min.js"></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js"></script>
<script type="text/javascript" src="../_static/bootstrap-3.4.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js"></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html">
          <!-- OMAS-->
        </a>
        <!-- <span class="navbar-text navbar-version pull-left"><b></b></span> -->
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../how.html">Concept</a></li>
                <li><a href="index.html">Examples</a></li>
                <li><a href="../install.html">Installation</a></li>
                <li><a href="../iter.html">ITER</a></li>
                <li><a href="../omfit.html">OMFIT</a></li>
                <li><a href="../schema.html">Data schema</a></li>
                <li><a href="../code.html">API</a></li>
            
            
              
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">In this page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">IMAS consistency check</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>
           <!-- 
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
           -->
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference internal" href="#sphx-glr-download-auto-examples-consistency-check-py"><span class="std std-ref">Go to the end</span></a>
to download the full example code</p>
</div>
<section class="sphx-glr-example-title" id="imas-consistency-check">
<span id="sphx-glr-auto-examples-consistency-check-py"></span><h1>IMAS consistency check<a class="headerlink" href="#imas-consistency-check" title="Link to this heading">¶</a></h1>
<p>OMAS can enforce consistency with IMAS data structure.
There are three possible settings:</p>
<ul class="simple">
<li><p><strong>consistency_check = False</strong>: no consistency check. <cite>False</cite> can be used to use OMAS for other purposes other than IMAS</p></li>
<li><p><strong>consistency_check = ‘warn’</strong>: will print a wanrning if entry is outside of IMAS scope. <cite>‘warn’</cite> can be useful when wanting to work with entries that are not yet supported by IMAS. Remember to open a JIRA issue (<a class="reference external" href="https://jira.iter.org">https://jira.iter.org</a>) to start a conversation about making these entries officially part of IMAS.</p></li>
<li><p><strong>consistency_check = True</strong>: will raise an error if entry is outside of IMAS scope. Recommended when working with IMAS. The error raised will clearly say where the error is, and provide suggestions based on valid IMAS structure.</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">omas</span> <span class="kn">import</span> <span class="o">*</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;consistency_check = False&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ods</span> <span class="o">=</span> <span class="n">ODS</span><span class="p">()</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="n">ods</span><span class="o">.</span><span class="n">consistency_check</span> <span class="o">=</span> <span class="kc">False</span>
<span class="c1"># can add entry with wrong dimensions</span>
<span class="n">ods</span><span class="p">[</span><span class="s1">&#39;equilibrium.time_slice[0].profiles_2d[0].b_tor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1"># can add entry that is obsolescent</span>
<span class="n">ods</span><span class="p">[</span><span class="s1">&#39;equilibrium.time_slice[0].profiles_2d[0].b_tor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="c1"># can add entry that does not exist in IMAS</span>
<span class="n">ods</span><span class="p">[</span><span class="s1">&#39;equilibrium.time_slice[0].does_not_exist.global_quantities.ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;consistency_check = &#39;warn&#39;&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ods</span> <span class="o">=</span> <span class="n">ODS</span><span class="p">()</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="n">ods</span><span class="o">.</span><span class="n">consistency_check</span> <span class="o">=</span> <span class="s1">&#39;warn&#39;</span>
<span class="c1"># can add entry with wrong dimensions but warning message is printed</span>
<span class="n">ods</span><span class="p">[</span><span class="s1">&#39;equilibrium.time_slice[0].profiles_2d[0].b_tor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="c1"># can add entry that is obsolescent but warning message is printed</span>
<span class="n">ods</span><span class="p">[</span><span class="s1">&#39;equilibrium.time_slice[0].profiles_2d[0].b_tor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="c1"># can add entry that does not exist in IMAS but warning message is printed</span>
<span class="n">ods</span><span class="p">[</span><span class="s1">&#39;equilibrium.time_slice[0].does_not_exist.global_quantities.ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>In the above example <cite>consistency_check = warn</cite> or <cite>True</cite> result in the following warnings:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">equilibrium</span><span class="o">.</span><span class="n">time_slice</span><span class="o">.</span><span class="p">:</span><span class="o">.</span><span class="n">profiles_2d</span><span class="o">.</span><span class="p">:</span><span class="o">.</span><span class="n">b_tor</span> <span class="n">must</span> <span class="n">be</span> <span class="n">an</span> <span class="n">array</span> <span class="k">with</span> <span class="n">dimensions</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;equilibrium.time_slice[:].profiles_2d[:].grid.dim1&#39;</span><span class="p">,</span> <span class="s1">&#39;equilibrium.time_slice[:].profiles_2d[:].grid.dim2&#39;</span><span class="p">]</span>
<span class="n">equilibrium</span><span class="o">.</span><span class="n">time_slice</span><span class="o">.</span><span class="p">:</span><span class="o">.</span><span class="n">profiles_2d</span><span class="o">.</span><span class="p">:</span><span class="o">.</span><span class="n">b_tor</span> <span class="ow">is</span> <span class="ow">in</span> <span class="n">OBSOLESCENT</span> <span class="n">state</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;consistency_check = True&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;*&#39;</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span>
<span class="n">ods</span> <span class="o">=</span> <span class="n">ODS</span><span class="p">()</span><span class="o">.</span><span class="n">sample</span><span class="p">()</span>
<span class="n">ods</span><span class="o">.</span><span class="n">consistency_check</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># this is the default</span>
<span class="c1"># add entry with wrong dimensions</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">ods</span><span class="p">[</span><span class="s1">&#39;equilibrium.time_slice[0].profiles_2d[0].b_tor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Was able to add an entry with wrong dimensions!&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
    <span class="k">pass</span>
<span class="c1"># add entry that is obsolescent</span>
<span class="n">ods</span><span class="p">[</span><span class="s1">&#39;equilibrium.time_slice[0].profiles_2d[0].grid.dim1&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="n">ods</span><span class="p">[</span><span class="s1">&#39;equilibrium.time_slice[0].profiles_2d[0].grid.dim2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">ods</span><span class="p">[</span><span class="s1">&#39;equilibrium.time_slice[0].profiles_2d[0].b_tor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span><span class="p">]</span>
<span class="c1"># add entry that does not exist in IMAS</span>
<span class="k">try</span><span class="p">:</span>
    <span class="n">ods</span><span class="p">[</span><span class="s1">&#39;equilibrium.time_slice[0].does_not_exist.global_quantities.ip&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;Was able to add an entry with that is not in IMAS even if consistency_check = True&#39;</span><span class="p">)</span>
<span class="k">except</span> <span class="ne">LookupError</span><span class="p">:</span>
    <span class="k">pass</span>
</pre></div>
</div>
<p>In the above example <cite>consistency_check = True</cite> result in the following error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>LookupError: Not a valid IMAS 3.18.0 location: `equilibrium.time_slice.:.does_not_exist`
                                                                         ^^^^^^^^^^^^^^
Did you mean: [&#39;profiles_2d&#39;, &#39;ggd&#39;, &#39;boundary&#39;, &#39;profiles_1d&#39;, &#39;constraints&#39;, &#39;global_quantities&#39;, &#39;coordinate_system&#39;, &#39;boundary_separatrix&#39;, &#39;time&#39;, &#39;convergence&#39;]
</pre></div>
</div>
<div class="sphx-glr-footer sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-consistency-check-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../_downloads/bb514dd1feafd0ef59611c6c42af0935/consistency_check.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">consistency_check.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../_downloads/9b78b5b6acb2372ed237f0afeac3e5ad/consistency_check.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">consistency_check.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2017-2025 O. Meneghini and collaborators.<br/>
      Last updated on Feb 27, 2025.<br/>
    </p>
  </div>
</footer>
  </body>
</html>