
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/omas_dynamic_imas.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_omas_dynamic_imas.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_omas_dynamic_imas.py:


Dynamic loading of IMAS data
============================
This example illustrates how OMAS can load in memory IMAS data only when it is first requested

.. GENERATED FROM PYTHON SOURCE LINES 8-49

.. code-block:: default


    import os
    from omas import *

    # set OMAS_DEBUG_TOPIC to see when data is loaded dynamically
    os.environ['OMAS_DEBUG_TOPIC'] = 'dynamic'

    user = os.environ.get('USER', "default_user")

    # generate some data and save it in IMAS
    ods = ODS().sample(ntimes=2)
    ods.save('imas', user, 'DIII-D', 1000, 0, new=True, verbose=True)

    # ODS.open() will keep the file descriptor open so that OMAS
    # can load in memory only the data when it is first requested
    # NOTE: one can use the `with` statement or open()/close()
    ods = ODS()
    with ods.open('imas', user, 'DIII-D', 1000, 0):
        # data gets read from IMAS when first requested
        print(ods['equilibrium.time_slice.:.global_quantities.ip'])
        # then it is in memory
        print(ods['equilibrium.time_slice.0.global_quantities.ip'])

    # save it as a pickle
    ods.save('test.pkl')

    # load the data back
    ods = ODS()
    ods.load('test.pkl')

    # the data that was loaded is stored in the pickle
    print(ods.flat().keys())

    # continue loading more data
    with ods.open('imas', user, 'DIII-D', 1000, 0):
        print(ods['equilibrium.time'])

    # tell us what IMAS elements have data
    with ods.open('imas', user, 'DIII-D', 1000, 0):
        print(ods.keys())
        print(ods['equilibrium.time_slice.0.profiles_1d'].keys())


.. _sphx_glr_download_auto_examples_omas_dynamic_imas.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example




    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: omas_dynamic_imas.py <omas_dynamic_imas.py>`

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: omas_dynamic_imas.ipynb <omas_dynamic_imas.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
